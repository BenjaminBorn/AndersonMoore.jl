module NumericShiftTests

# test numericShift 
import AMAFUNCS.numericShift!
import AMAFUNCS.sameSpan

#tweaked= False
# test numericShift! firmvalue example
function firmvalueFalse()::Bool


neq=4::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,4,8)

hhIn=[0.  0.  0.  0.  -1.1  0.  0.  0.  1.  1.  0.  0.;
0.  -0.4  0.  0.  0.  1.  -1.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.;
0.  0.  0.  -1.  0.  0.  0.  1.  0.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.  0.  0.  -1.1  0.  0.  0.  1.  1.  0.  0.;
0.  0.  0.  0.  0.  -0.4  0.  0.  0.  1.  -1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.;
0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  1.]::Array{Float64,2}

qNewMatlab=[0.  -0.4  0.  0.  0.  1.  -1.  0.;
0.  0.  0.  0.  0.  0.  1.  0.;
0.  0.  0.  -1.  0.  0.  0.  1.;
0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=3

nnumericMatlab=3

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= False
# test numericShift! firmvalue3Leads2Lags example
function firmvalue3Leads2LagsFalse()::Bool


neq=4::Int64;nlag=2::Int64;nlead=3::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,12,20)

hhIn=[0.  0.  0.  0.  0.  0.  0.  0.  -1.331  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.;
0.  -0.4  0.  0.  0.  0.  0.  0.  0.  1.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.  0.  0.  0.  0.  0.  0.  -1.331  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.4  0.  0.  0.  0.  0.  0.  0.  1.  -1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  1.]::Array{Float64,2}

qNewMatlab=[0.  -0.4  0.  0.  0.  0.  0.  0.  0.  1.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  -0.4  0.  0.  0.  0.  0.  0.  0.  1.  -1.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  1.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.4  0.  0.  0.  0.  0.  0.  0.  1.  -1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  1.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=9

nnumericMatlab=9

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= False
# test numericShift! example7 example
function example7False()::Bool


neq=4::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,4,8)

hhIn=[0.  0.  0.  0.  1.  0.  0.  1.  -1.  -1.  0.  0.;
0.  0.  0.  0.  -0.3  1.  0.  0.  0.  -0.99  0.  0.;
0.  0.  0.  1.  0.  0.  1.  -1.  0.  0.  0.  0.;
0.  0.  0.  -0.66  0.  -1.1  0.  1.  0.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.  0.  0.  -0.499588  -0.703545  0.  -0.710651  0.710651  1.40716  0.  0.;
0.  0.  0.  0.  -0.91674  0.710651  0.  -0.703545  0.703545  0.000000000000000111022  0.  0.;
0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  1.  -1.;
0.  0.  0.  0.  0.  0.  0.  -0.66  0.  -1.1  0.  1.]::Array{Float64,2}

qNewMatlab=[0.  0.  0.  1.  0.  0.  1.  -1.;
0.  0.  0.  -0.66  0.  -1.1  0.  1.;
0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=2

nnumericMatlab=2

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= False
# test numericShift! oneEquationNoLead example
function oneEquationNoLeadFalse()::Bool


neq=1::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,1,2)

hhIn=[2.  3.  0.]::Array{Float64,2}

hNewMatlab=[0.  2.  3.]::Array{Float64,2}

qNewMatlab=[2.  3.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=1

nnumericMatlab=1

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= False
# test numericShift! reliablePaperExmpl example
function reliablePaperExmplFalse()::Bool


neq=5::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,5,10)

hhIn=[0.  0.  0.  -0.5  0.  0.  -1.  0.7  -0.5  1.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.5  0.  0.  0.  0.  -0.5;
0.  0.  0.  0.  0.  -1.  0.  1.  -0.4  0.  0.  0.  -0.9  0.  0.;
0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.  0.  0.  0.  -1.  0.  1.  -0.4  0.  0.  0.  -0.9  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.5  0.  0.  0.  0.  -0.5;
0.  0.  0.  0.  0.  0.  0.  0.  -0.5  0.  0.  -1.  0.7  -0.5  1.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.]::Array{Float64,2}

qNewMatlab=[0.  0.  0.  -0.5  0.  0.  -1.  0.7  -0.5  1.;
0.  0.  0.  0.  0.  1.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=3

nnumericMatlab=3

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= False
# test numericShift! athan example
function athanFalse()::Bool


neq=9::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,9,18)

hhIn=[-0.5  0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.18  0.  0.  -1.  0.  0.  0.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.293  -0.764  0.293  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  -2.  -1.  1.  1.  0.  0.  2.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  -0.911  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[-0.5  0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.18  0.  0.  -1.  0.  0.  0.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.293  -0.764  0.293  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  -1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -2.  -1.  1.  1.  0.  0.  2.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.911  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  -1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  1.]::Array{Float64,2}

qNewMatlab=[-0.293  -0.764  0.293  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  -1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  -2.  -1.  1.  1.  0.  0.  2.  0.  0.;
0.  0.  0.  -0.911  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  -1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  1.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=8

nnumericMatlab=8


(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= False
# test numericShift! habitmod example
function habitmodFalse()::Bool


neq=12::Int64;nlag=4::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,12,60)

hhIn=[0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  -1.  -1.  0.  0.  3.45419  0.  0.  -0.74118  0.00208517  0.494116  -0.1149  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.88879  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.52802  0.  0.11279  0.031833  0.024734  0.  0.  0.  0.  0.  0.  0.  -0.71526  0.  0.042076  -0.22829  -0.012267  0.  0.  0.  0.  0.  0.  0.  0.22215  0.  -0.14172  0.26679  -0.11959  0.  0.  0.  0.  0.  0.  0.  -0.42308  0.  -0.61076  -0.10946  0.17172  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  -0.00011277  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.46436  0.  0.16131  0.02744  0.17087  0.  0.  0.  0.  0.  0.  0.  -1.3425  0.  0.16794  -0.35818  -0.09837  0.  0.  0.  0.  0.  0.  0.  1.06382  0.  -0.02255  0.51594  0.08949  0.  0.  0.  0.  0.  0.  0.  -0.46672  0.  -0.11369  -1.10657  -0.26021  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  -0.00141  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
-0.23292  0.  0.08512  -0.04213  0.14149  0.  0.  0.  0.  0.  0.  0.  0.03313  0.  0.15223  0.01572  -0.34762  0.  0.  0.  0.  0.  0.  0.  0.70552  0.  -0.24697  0.21888  -0.07805  0.  0.  0.  0.  0.  0.  0.  -0.56316  0.  -0.08268  -0.16054  -0.68637  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  -0.00348  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  -41.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  40.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.99853  0.  0.  0.  0.  0.  -0.00147  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  0.  0.  0.  0.  25.9459  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.00146853  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  -0.99578  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  -0.99578  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  41.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  -40.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.00146974  0.  0.  0.  0.  0.  0.0381023  1.00147  0.  0.999999  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  -0.995779  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  -0.99578  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.0000000000000585256  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.00082  0.0000000000000658486  0.  0.  0.  0.  -25.9458  -0.99853  0.  0.00146853  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.00146233  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  1.  1.  0.  0.  -3.45419  0.  0.  0.74118  -0.00208517  -0.494116  0.1149;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.99853  0.  0.  0.  0.  0.  -0.00147  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.23292  0.  -0.0851199  0.04213  -0.14149  0.  0.  0.  0.  0.  0.  0.  -0.03313  0.  -0.15223  -0.01572  0.34762  0.  0.  0.  0.  0.  0.  0.  -0.705519  0.  0.24697  -0.21888  0.0780499  0.  0.  0.  0.  0.  0.  0.  0.563159  -0.00130521  0.0826799  0.16054  0.686369  0.  0.  0.  0.  0.  0.  0.  0.0000000000000000156467  0.00146853  0.  0.  -0.999999  0.  -0.000000000000000405633  -0.0000000000000000155741  0.  0.0000000000000000000596664  0.  0.00348;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.52802  0.  0.11279  0.031833  0.024734  0.  0.  0.  0.  0.  0.  0.  -0.71526  0.  0.042076  -0.22829  -0.012267  0.  0.  0.  0.  0.  0.  0.  0.22215  0.  -0.14172  0.26679  -0.11959  0.  0.  0.  0.  0.  0.  0.  -0.42308  0.  -0.61076  -0.10946  0.17172  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  -0.00011277;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.00034205  0.  0.000125001  -0.0000618691  0.000207782  0.  0.  0.  0.  0.  0.  0.  0.0000486523  0.  0.000223554  0.0000230853  -0.00051049  0.  0.  0.  0.  0.  0.  0.  0.00103608  0.  -0.000362682  0.000321431  -0.000114619  0.  0.  0.  0.  0.  0.  0.  -0.000827016  -0.888789  -0.000121418  -0.000235758  -0.00100795  0.  0.  0.  0.  0.  0.  0.  -0.0000000000000659031  0.999999  0.  0.  0.00146853  0.  0.0000000000017085  0.0000000000000658794  0.  0.0000000000000000306214  0.  -0.00000511048;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.46436  0.  0.16131  0.02744  0.17087  0.  0.  0.  0.  0.  0.  0.  -1.3425  0.  0.16794  -0.35818  -0.09837  0.  0.  0.  0.  0.  0.  0.  1.06382  0.  -0.02255  0.51594  0.08949  0.  0.  0.  0.  0.  0.  0.  -0.46672  0.  -0.11369  -1.10657  -0.26021  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  -0.00141;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.]::Array{Float64,2}

qNewMatlab=[0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  1.  1.  0.  0.  -3.45419  0.  0.  0.74118  -0.00208517  -0.494116  0.1149;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.99853  0.  0.  0.  0.  0.  -0.00147  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.;
0.23292  0.  -0.0851199  0.04213  -0.14149  0.  0.  0.  0.  0.  0.  0.  -0.03313  0.  -0.15223  -0.01572  0.34762  0.  0.  0.  0.  0.  0.  0.  -0.705519  0.  0.24697  -0.21888  0.0780499  0.  0.  0.  0.  0.  0.  0.  0.563159  -0.00130521  0.0826799  0.16054  0.686369  0.  0.  0.  0.  0.  0.  0.  0.0000000000000000156467  0.00146853  0.  0.  -0.999999  0.  -0.000000000000000405633  -0.0000000000000000155741  0.  0.0000000000000000000596664  0.  0.00348;
0.52802  0.  0.11279  0.031833  0.024734  0.  0.  0.  0.  0.  0.  0.  -0.71526  0.  0.042076  -0.22829  -0.012267  0.  0.  0.  0.  0.  0.  0.  0.22215  0.  -0.14172  0.26679  -0.11959  0.  0.  0.  0.  0.  0.  0.  -0.42308  0.  -0.61076  -0.10946  0.17172  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  -0.00011277;
-0.00034205  0.  0.000125001  -0.0000618691  0.000207782  0.  0.  0.  0.  0.  0.  0.  0.0000486523  0.  0.000223554  0.0000230853  -0.00051049  0.  0.  0.  0.  0.  0.  0.  0.00103608  0.  -0.000362682  0.000321431  -0.000114619  0.  0.  0.  0.  0.  0.  0.  -0.000827016  -0.888789  -0.000121418  -0.000235758  -0.00100795  0.  0.  0.  0.  0.  0.  0.  -0.0000000000000659031  0.999999  0.  0.  0.00146853  0.  0.0000000000017085  0.0000000000000658794  0.  0.0000000000000000306214  0.  -0.00000511048;
0.46436  0.  0.16131  0.02744  0.17087  0.  0.  0.  0.  0.  0.  0.  -1.3425  0.  0.16794  -0.35818  -0.09837  0.  0.  0.  0.  0.  0.  0.  1.06382  0.  -0.02255  0.51594  0.08949  0.  0.  0.  0.  0.  0.  0.  -0.46672  0.  -0.11369  -1.10657  -0.26021  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  -0.00141;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=7

nnumericMatlab=7

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= True
# test numericShift! firmvalue example
function firmvalueTrue()::Bool


neq=4::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,4,8)

hhIn=[0.  0.  0.  0.  -2.2  0.  0.  0.  2.  2.  0.  0.;
0.  -0.4  0.  0.  -1.1  1.  -1.  0.  1.  1.  0.  0.;
0.  0.  0.  0.  -1.1  0.  1.  0.  1.  1.  0.  0.;
0.  0.  0.  -1.  -1.1  0.  0.  1.  1.  1.  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.151186  0.  0.377964  2.91033  -0.377964  0.  -0.377964  -2.64575  -2.64575  0.  0.;
0.  0.  0.  0.  0.  0.174574  0.  0.436436  0.000000000000000222045  -0.436436  0.000000000000000111022  -0.436436;
0.  0.  0.  0.  0.  0.23094  0.  0.211325  -0.000000000000000166533  -0.57735  1.36603  -0.211325;
0.  0.  0.  0.  0.  0.23094  0.  -0.788675  -0.000000000000000111022  -0.57735  0.366025  0.788675]::Array{Float64,2}

qNewMatlab=[0.  0.174574  0.  0.436436  0.000000000000000222045  -0.436436  0.000000000000000111022  -0.436436;
0.  0.23094  0.  0.211325  -0.000000000000000166533  -0.57735  1.36603  -0.211325;
0.  0.23094  0.  -0.788675  -0.000000000000000111022  -0.57735  0.366025  0.788675;
0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=3

nnumericMatlab=3

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= True
# test numericShift! firmvalue3Leads2Lags example
function firmvalue3Leads2LagsTrue()::Bool


neq=4::Int64;nlag=2::Int64;nlead=3::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,12,20)

hhIn=[0.  0.  0.  0.  0.  0.  0.  0.  -2.662  0.  0.  0.  0.  2.  0.  0.  0.  0.  0.  0.  2.  0.  0.  0.;
0.  -0.4  0.  0.  0.  0.  0.  0.  -1.331  1.  -1.  0.  0.  1.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  -1.331  0.  1.  0.  0.  1.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  -1.  -1.331  0.  0.  1.  0.  1.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.151186  0.  0.  0.  0.  0.  0.377964  3.52149  -0.377964  0.  -0.377964  0.  -2.64575  0.  0.  0.  0.  0.  0.  -2.64575  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.31411  0.  0.  0.  0.  0.  -0.109152  0.0000000000000000496507  -0.785275  0.447214  0.109152;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.193439  0.  0.  0.  0.  0.  0.036384  -0.0000000000000000993014  -0.483598  1.34164  -0.036384;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0325428  0.  0.  0.  0.  0.  -0.918643  0.  -0.081357  0.  0.918643]::Array{Float64,2}

qNewMatlab=[0.  -0.367457  0.  0.  0.  0.  0.  0.081357  0.  0.918643  -1.  -0.081357  0.  0.0000000000000000555112  0.  0.  0.  0.  0.  0.;
0.  0.0325428  0.  0.  0.  0.  0.  0.081357  -0.000000000000000111022  -0.081357  1.  -0.081357  0.  0.0000000000000000277556  0.  0.  0.  0.  0.  0.;
0.  0.0325428  0.  0.  0.  0.  0.  -0.918643  0.  -0.081357  0.  0.918643  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  -0.367457  0.  0.  0.  0.  0.  0.081357  0.  0.918643  -1.  -0.081357  0.  0.0000000000000000555112  0.  0.;
0.  0.  0.  0.  0.  0.0325428  0.  0.  0.  0.  0.  0.081357  -0.000000000000000111022  -0.081357  1.  -0.081357  0.  0.0000000000000000277556  0.  0.;
0.  0.  0.  0.  0.  0.0325428  0.  0.  0.  0.  0.  -0.918643  0.  -0.081357  0.  0.918643  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.31411  0.  0.  0.  0.  0.  -0.109152  0.0000000000000000496507  -0.785275  0.447214  0.109152;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.193439  0.  0.  0.  0.  0.  0.036384  -0.0000000000000000993014  -0.483598  1.34164  -0.036384;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0325428  0.  0.  0.  0.  0.  -0.918643  0.  -0.081357  0.  0.918643;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=9

nnumericMatlab=9

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= True
# test numericShift! example7 example
function example7True()::Bool


neq=4::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,4,8)

hhIn=[0.  0.  0.  0.  1.7  1.  0.  2.  -2.  -2.99  0.  0.;
0.  0.  0.  0.  0.4  2.  0.  1.  -1.  -2.98  0.  0.;
0.  0.  0.  1.  0.7  1.  1.  0.  -1.  -1.99  0.  0.;
0.  0.  0.  -0.66  0.7  -0.1  0.  2.  -1.  -1.99  0.  0.]::Array{Float64,2}

hNewMatlab=[0.  0.  0.  -0.133359  -1.78594  -2.11707  -0.392232  -2.55049  2.55049  5.07353  0.  0.;
0.  0.  0.  -0.000185865  0.916751  -0.710058  -0.000546661  0.703553  -0.703553  -0.000000000000000398553  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.971449  0.000000000000000117961  0.0923723  0.916025  -1.;
0.  0.  0.  0.  0.  0.  0.  -0.688551  0.  -1.00763  -0.0839749  1.]::Array{Float64,2}

qNewMatlab=[0.  0.  0.  0.971449  0.000000000000000117961  0.0923723  0.916025  -1.;
0.  0.  0.  -0.688551  0.  -1.00763  -0.0839749  1.;
0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=2

nnumericMatlab=2

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= True
# test numericShift! oneEquationNoLead example
function oneEquationNoLeadTrue()::Bool


neq=1::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,1,2)

hhIn=[2.  3.  0.]::Array{Float64,2}

hNewMatlab=[0.  2.  3.]::Array{Float64,2}

qNewMatlab=[2.  3.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=1

nnumericMatlab=1

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= True
# test numericShift! reliablePaperExmpl example
function reliablePaperExmplTrue()::Bool


neq=5::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,5,10)

hhIn=[0.  0.  0.  -0.5  0.  -1.  -1.  1.7  0.1  0.5  0.  0.  -0.9  0.  -0.5;
0.  0.  0.  0.  0.  -1.  0.  1.  1.6  -1.  0.  0.  -0.9  0.  -1.;
0.  0.  0.  0.  0.  -2.  0.  2.  0.2  -0.5  0.  0.  -1.8  0.  -0.5;
0.  0.  0.  0.  0.  0.  0.  1.  0.6  -0.5  0.  0.  -0.9  0.  -0.5;
0.  0.  0.  0.  0.  -1.  1.  1.  0.6  -0.5  0.  0.  -0.9  0.  -0.5]::Array{Float64,2}

hNewMatlab=[0.  0.  0.  0.176777  0.  2.47487  0.  -3.07591  -1.16673  0.883883  0.  0.  2.54558  0.  1.23744;
0.  0.  0.  0.0456435  0.  -0.0912871  -0.000000000000000360822  -0.063901  -1.32366  0.593366  0.  0.  0.000000000000000194289  0.  0.684653;
0.  0.  0.  0.  0.  0.  0.  0.  0.396985  0.  -0.185051  0.608919  -0.555779  0.396985  -0.793969;
0.  0.  0.  0.  0.  0.  0.  0.  0.171857  0.  0.90769  0.251405  -0.2406  0.171857  -0.343714;
0.  0.  0.  0.  0.  0.  0.  0.  0.171857  0.  -0.0923097  1.2514  -0.2406  0.171857  -0.343714]::Array{Float64,2}

qNewMatlab=[0.  0.  0.  0.396985  0.  -0.185051  0.608919  -0.555779  0.396985  -0.793969;
0.  0.  0.  0.171857  0.  0.90769  0.251405  -0.2406  0.171857  -0.343714;
0.  0.  0.  0.171857  0.  -0.0923097  1.2514  -0.2406  0.171857  -0.343714;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=3

nnumericMatlab=3

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= True
# test numericShift! athan example
function athanTrue()::Bool


neq=9::Int64;nlag=1::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,9,18)

hhIn=[-1.  0.  0.  0.  0.  0.  0.  0.  0.  2.  -0.36  0.  0.  -2.  0.  0.  0.  0.  -1.  0.  0.  0.  0.  0.  0.  0.  0.;
-0.793  -0.764  0.293  0.  0.  0.  0.  0.  0.  1.  0.82  0.  0.  -1.  -1.  0.  0.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.5  0.  0.  0.  0.  0.  0.  0.  0.  -1.  -1.18  1.  1.  -1.  0.  2.  0.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.5  0.  0.  -0.911  0.  0.  0.  0.  0.  1.  -0.18  0.  1.  -1.  0.  0.  -1.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.5  0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.18  0.  0.  0.  0.  0.  0.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.5  0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.18  0.  0.  -1.  1.  0.  0.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.5  0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.18  0.  0.  -1.  0.  1.  0.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.5  0.  0.  0.  0.  0.  0.  0.  0.  1.  -0.18  0.  0.  -1.  0.  0.  1.  0.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.;
-0.5  0.  0.  0.  0.  0.  0.  0.  -1.  1.  -0.18  0.  0.  -1.  0.  0.  0.  1.  -0.5  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

hNewMatlab=[1.81663  0.220548  -0.0845818  0.262983  0.  0.  0.  0.  0.288675  -2.88675  0.623538  -0.288675  -0.57735  3.17543  0.  -0.866025  0.  -0.288675  1.73205  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.27752  -0.723637  0.27752  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  1.  -0.0528312  -0.105662  -0.0528312  -1.  -0.158494  0.  -0.0528312;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  -1.89434  -1.  0.947169  0.894338  -0.0528312  0.  1.84151  0.  -0.0528312;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0154795  0.040363  -0.0154795  -0.862871  0.  0.  0.  0.  0.0528312  0.105662  -0.0000000000000000277556  -0.0528312  0.894338  -0.0528312  0.  -0.158494  -1.  -0.0528312;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  -0.0000000000000000277556  -0.0528312  -0.105662  0.947169  0.  -0.158494  0.  -0.0528312;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  -0.0000000000000000138778  -0.0528312  -0.105662  -0.0528312  1.  -0.158494  0.  -0.0528312;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  0.  -0.0528312  -0.105662  -0.0528312  0.  0.841506  0.  -0.0528312;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  0.0000000000000000138778  -0.0528312  -0.105662  -0.0528312  0.  -0.158494  1.  -0.0528312;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  -0.947169  0.105662  0.0000000000000000277556  -0.0528312  -0.105662  -0.0528312  0.  -0.158494  0.  0.947169]::Array{Float64,2}

qNewMatlab=[-0.27752  -0.723637  0.27752  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  1.  -0.0528312  -0.105662  -0.0528312  -1.  -0.158494  0.  -0.0528312;
0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  -1.89434  -1.  0.947169  0.894338  -0.0528312  0.  1.84151  0.  -0.0528312;
0.0154795  0.040363  -0.0154795  -0.862871  0.  0.  0.  0.  0.0528312  0.105662  -0.0000000000000000277556  -0.0528312  0.894338  -0.0528312  0.  -0.158494  -1.  -0.0528312;
0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  -0.0000000000000000277556  -0.0528312  -0.105662  0.947169  0.  -0.158494  0.  -0.0528312;
0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  -0.0000000000000000138778  -0.0528312  -0.105662  -0.0528312  1.  -0.158494  0.  -0.0528312;
0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  0.  -0.0528312  -0.105662  -0.0528312  0.  0.841506  0.  -0.0528312;
0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  0.0528312  0.105662  0.0000000000000000138778  -0.0528312  -0.105662  -0.0528312  0.  -0.158494  1.  -0.0528312;
0.0154795  0.040363  -0.0154795  0.0481292  0.  0.  0.  0.  -0.947169  0.105662  0.0000000000000000277556  -0.0528312  -0.105662  -0.0528312  0.  -0.158494  0.  0.947169;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=8

nnumericMatlab=8

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

#tweaked= True
# test numericShift! habitmod example
function habitmodTrue()::Bool


neq=12::Int64;nlag=4::Int64;nlead=1::Int64
qRows=(neq*nlead)::Int64;qCols=(neq*(nlag+nlead))::Int64


qq=zeros(Float64,12,60)

hhIn=[0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.000825426  -1.  0.  1.  0.  -37.5458  26.9459  2.  0.25882  1.00209  1.49412  -0.1149  0.  0.  -1.  0.  -1.  40.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.88879  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.00083  1.  1.  1.  0.  -41.  26.9459  2.  1.  1.  1.  0.  0.  0.  -1.  0.  -1.  40.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.;
0.52802  0.  0.11279  0.031833  0.024734  0.  0.  0.  0.  0.  0.  0.  -0.71526  0.  0.042076  -0.22829  -0.012267  0.  0.  0.  0.  0.  0.  0.  0.22215  0.  -0.14172  0.26679  -0.11959  0.  0.  0.  0.  0.  0.  0.  -0.42308  0.  -0.61076  -0.10946  0.17172  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  2.  1.  0.  -41.  26.9459  2.  1.  1.  1.  -0.00011277  0.  0.  -1.  0.  -1.  40.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.;
0.46436  0.  0.16131  0.02744  0.17087  0.  0.  0.  0.  0.  0.  0.  -1.3425  0.  0.16794  -0.35818  -0.09837  0.  0.  0.  0.  0.  0.  0.  1.06382  0.  -0.02255  0.51594  0.08949  0.  0.  0.  0.  0.  0.  0.  -0.46672  0.  -0.11369  -1.10657  -0.26021  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  1.  2.  0.  -41.  26.9459  2.  1.  1.  1.  -0.00141  0.  0.  -1.  0.  -1.  40.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.;
-0.23292  0.  0.08512  -0.04213  0.14149  0.  0.  0.  0.  0.  0.  0.  0.03313  0.  0.15223  0.01572  -0.34762  0.  0.  0.  0.  0.  0.  0.  0.70552  0.  -0.24697  0.21888  -0.07805  0.  0.  0.  0.  0.  0.  0.  -0.56316  0.  -0.08268  -0.16054  -0.68637  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  1.  1.  1.  -41.  26.9459  2.  1.  1.  1.  -0.00348  0.  0.  -1.  0.  -1.  40.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  1.  2.  0.  -82.  26.9459  2.  1.  1.  1.  0.  0.  0.  -1.  0.  -2.  80.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.99853  0.  0.  0.  0.  0.  -0.00147  0.  0.  0.  0.  0.  -1.00083  0.  1.  1.  0.  -41.  27.9459  2.  1.  1.  1.  0.  0.  0.  -1.  0.  -1.  40.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -2.00165  0.  1.  1.  0.  -41.  52.8917  3.  1.  1.  1.  0.  0.  0.  -1.  0.  -1.  40.  -1.  -1.00294  -0.99578  -0.99578  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  2.  1.  0.  -41.  26.9459  2.  2.  1.  1.  0.  0.  0.  -2.  0.  -1.  40.  -1.  -1.00147  -1.99156  -0.99578  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  1.  1.  0.  -41.  26.9459  3.  1.  2.  1.  0.  0.  0.  -1.  0.  -1.  40.  -1.  -2.00147  -0.99578  -1.99156  -0.99578  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.00083  0.  1.  1.  0.  -41.  27.9459  2.  1.  1.  2.  0.  0.  0.  -1.  0.  -1.  40.  -2.  -1.00147  -0.99578  -0.99578  -1.99156  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -1.  -1.00083  0.  1.  1.  0.  -41.  26.9459  2.  1.  1.  1.  1.  0.  0.  -1.  0.  -1.  40.  -1.  -1.00147  -0.99578  -0.99578  -0.99578  0.]::Array{Float64,2}

hNewMatlab=[-0.196092  0.  -0.0927502  -0.0044263  -0.0870373  0.  0.  0.  0.  0.  0.  0.  0.522757  0.  -0.0935315  0.147367  0.118321  0.  0.  0.  0.  0.  0.  0.  -0.514201  0.  0.106182  -0.258615  0.0279242  0.  0.  0.  0.  0.  0.  0.  0.632972  0.229485  0.2084  0.355429  0.200068  0.  0.000379552  0.  0.  0.  0.  0.258199  3.35957  0.0000000000000000555112  -3.61478  -4.13118  -0.258199  157.9  -97.6617  -7.22957  -3.42341  -3.61532  -3.74236  -0.22724  0.  0.  3.61478  0.  3.87298  -154.919  3.61478  3.62009  3.59953  3.59953  3.59953  0.;
-0.0364409  0.  -0.0172363  -0.000822567  -0.0161747  0.  0.  0.  0.  0.  0.  0.  0.0971472  0.  -0.0173815  0.0273861  0.0219884  0.  0.  0.  0.  0.  0.  0.  -0.095557  0.  0.0197324  -0.0480599  0.00518933  0.  0.  0.  0.  0.  0.  0.  0.117629  0.0426465  0.0387283  0.0660515  0.0371799  0.  0.0000705345  0.  0.  0.  0.  0.0479827  0.625386  0.000000000000000346945  -0.671758  -0.0479827  -0.0479827  -0.165741  -18.1765  -2.06326  -0.636194  -1.39054  -0.695467  -0.0422294  0.  0.  0.671758  0.  -0.0000000000000000832667  0.00000000000000799361  0.671758  1.39143  0.668923  1.38457  0.668923  0.;
-0.0214811  0.  -0.0101604  -0.000484885  -0.0095346  0.  0.  0.  0.  0.  0.  0.  0.057266  0.  -0.010246  0.0161435  0.0129617  0.  0.  0.  0.  0.  0.  0.  -0.0563287  0.  0.0116318  -0.0283302  0.00305899  0.  0.  0.  0.  0.  0.  0.  0.0693397  0.0251392  0.0228294  0.0389359  0.0219167  0.  0.0000415785  0.  0.  0.  0.  0.0282847  0.367445  0.000000000000000131839  -1.21741  -0.0282847  -0.0282847  -0.0977006  -10.6834  -0.394823  -1.19644  0.000521683  -0.409962  -0.0248933  0.  0.  1.21741  0.  0.0000000000000000346945  -0.0000000000000039968  0.395986  0.0000000000000000485723  1.21227  -0.000578211  0.394315  0.;
-0.0153274  0.  -0.00724978  -0.00034598  -0.00680323  0.  0.  0.  0.  0.  0.  0.  0.0408611  0.  -0.00731085  0.0115189  0.00924854  0.  0.  0.  0.  0.  0.  0.  -0.0401923  0.  0.00829965  -0.0202145  0.00218268  0.  0.  0.  0.  0.  0.  0.  0.049476  0.0179376  0.0162895  0.0277819  0.0156382  0.  0.0000296675  0.  0.  0.  0.  0.020182  0.262183  -0.0000000000000000138778  -0.000000000000000305311  -0.020182  -0.020182  -0.0697124  -8.49156  -0.281718  0.0149585  0.000372237  -1.16118  -0.0177621  0.  0.  0.0000000000000000832667  0.  0.0000000000000000832667  -0.00000000000000421885  1.1512  0.0000000000000000693889  -0.0000000000000000381639  -0.000412572  1.14635  0.;
-0.0119163  0.  -0.00563636  -0.000268983  -0.00528919  0.  0.  0.  0.  0.  0.  0.  0.0317676  0.  -0.00568384  0.00895538  0.0071903  0.  0.  0.  0.  0.  0.  0.  -0.0312476  0.  0.00645258  -0.0157158  0.00169693  0.  0.  0.  0.  0.  0.  0.  0.0384652  0.0139456  0.0126643  0.0215991  0.012158  0.  0.0000230651  0.  0.  0.  0.  0.0156905  1.1009  -0.000000000000276505  0.0000000000000367449  -0.0156905  -0.0156905  -0.0541981  -28.9627  -1.11403  0.0116295  0.00160567  -0.00775296  -0.0138092  0.  0.  0.00000000000000000346945  0.  -0.0000000000000000520417  0.00000000000000566214  -0.000000000000000107553  0.0000000000000000797973  0.0000000000000000954098  -0.00163148  0.0000000000000000954098  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.335405  0.  0.0436342  0.0242936  -0.0271634  0.  0.  0.  0.  0.  0.  0.  -0.312735  0.  -0.0161772  -0.110545  0.0548612  0.  0.  0.  0.  0.  0.  0.  -0.0966345  0.  -0.0605307  0.0816082  -0.0850455  0.  0.  0.  0.  0.  0.  0.  -0.00668345  0.0640719  -0.398106  0.103825  0.254381  0.  0.000209028  0.  0.  0.  0.  0.142196  0.605381  -0.67747  0.0921584  -0.142196  -0.142196  2.0911  -0.142196  0.0000000000000162648  -0.448697  0.00126232  0.299129  -0.211138;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.297407  0.  -0.0674404  -0.0161992  -0.012511  0.  0.  0.  0.  0.  0.  0.  0.367889  0.  -0.0247842  0.122297  0.0226985  0.  0.  0.  0.  0.  0.  0.  -0.111551  0.  0.1069  -0.150684  0.0900144  0.  0.  0.  0.  0.  0.  0.  0.341583  0.0744644  0.397553  0.0000677062  -0.0886312  0.  0.00009273  0.  0.  0.  0.  0.0630817  0.736948  -0.82073  -1.3931  0.0739959  -0.0630817  2.54556  -0.0630817  -0.00000000000000377476  -0.546211  0.00153666  0.364138  -0.147568;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.264172  0.  -0.0142305  -0.0281176  0.0136133  0.  0.  0.  0.  0.  0.  0.  0.429862  0.  0.0180164  0.120136  -0.124937  0.  0.  0.  0.  0.  0.  0.  0.00326808  0.  -0.0931677  -0.06289  -0.0511603  0.  0.  0.  0.  0.  0.  0.  -0.530657  -0.219733  0.0344385  0.240695  -0.241231  0.  -0.000646028  0.  0.  0.  0.  -0.439475  0.141415  0.105813  -0.206128  -0.274872  0.439475  0.488472  0.439475  -0.0000000000000586198  -0.104814  0.000294874  0.0698752  0.422092;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0570245  0.  -0.0279439  0.0111464  -0.0467962  0.  0.  0.  0.  0.  0.  0.  0.037279  0.  -0.0490003  0.00681408  0.0997783  0.  0.  0.  0.  0.  0.  0.  -0.241121  0.  0.0639716  -0.0779221  0.0126659  0.  0.  0.  0.  0.  0.  0.  -0.610873  0.481671  0.00815942  0.098117  0.207004  0.  -0.00114112  0.  0.  0.  0.  0.140158  -0.000000000000185074  -0.54194  0.0333889  -0.0523045  -0.27341  -0.00000000000000177636  0.776273  0.000000000000185019  0.0000000000000000277556  0.000000000000000166533  0.0000000000000000277556  -0.139136;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.0446255  0.  0.0872105  -0.0208645  0.1198  0.  0.  0.  0.  0.  0.  0.  -0.23506  0.  0.127279  -0.0605084  -0.240235  0.  0.  0.  0.  0.  0.  0.  0.636984  0.  -0.171034  0.238991  -0.0431004  0.  0.  0.  0.  0.  0.  0.  -0.224732  0.623252  -0.107629  -0.28619  -0.473214  0.  0.000349464  0.  0.  0.  0.  -0.0905662  -0.000000000000245581  -0.701236  0.0593956  0.159336  0.643899  0.00000000000000310862  -0.23773  0.000000000000245498  -0.0000000000000000277556  0.0000000000000001249  -0.0000000000000000693889  0.0880941;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  -0.472443  0.  -0.141047  -0.0311881  -0.137995  0.  0.  0.  0.  0.  0.  0.  1.24527  0.  -0.135171  0.335223  0.0489882  0.  0.  0.  0.  0.  0.  0.  -0.883137  0.  0.000313141  -0.451698  -0.081838  0.  0.  0.  0.  0.  0.  0.  0.494699  0.0654831  0.128  0.976843  0.144181  0.  0.000172319  0.  0.  0.  0.  0.0545049  0.000000000000000999201  -0.0736767  -0.0586851  -0.893499  0.11399  0.00000000000000799361  -0.117224  -0.00000000000000122125  -0.0000000000000000832667  -0.0000000000000000555112  0.  -0.0536351;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.0942838  0.  -0.0443322  0.0185761  -0.071841  0.  0.  0.  0.  0.  0.  0.  0.0324539  0.  -0.0763846  0.00496566  0.163326  0.  0.  0.  0.  0.  0.  0.  -0.365942  0.  0.112073  -0.118699  0.0301679  0.  0.  0.  0.  0.  0.  0.  0.470204  0.22726  0.0339707  0.11974  0.328162  0.  0.000291723  0.  0.  0.  0.  -0.825483  -0.0000000000000868194  -0.255696  0.0144344  -0.0431704  -0.458135  -0.00000000000000710543  -0.198451  0.0000000000000868194  0.000000000000000222045  0.000000000000000111022  0.  0.827137]::Array{Float64,2}

qNewMatlab=[0.335405  0.  0.0436342  0.0242936  -0.0271634  0.  0.  0.  0.  0.  0.  0.  -0.312735  0.  -0.0161772  -0.110545  0.0548612  0.  0.  0.  0.  0.  0.  0.  -0.0966345  0.  -0.0605307  0.0816082  -0.0850455  0.  0.  0.  0.  0.  0.  0.  -0.00668345  0.0640719  -0.398106  0.103825  0.254381  0.  0.000209028  0.  0.  0.  0.  0.142196  0.605381  -0.67747  0.0921584  -0.142196  -0.142196  2.0911  -0.142196  0.0000000000000162648  -0.448697  0.00126232  0.299129  -0.211138;
-0.297407  0.  -0.0674404  -0.0161992  -0.012511  0.  0.  0.  0.  0.  0.  0.  0.367889  0.  -0.0247842  0.122297  0.0226985  0.  0.  0.  0.  0.  0.  0.  -0.111551  0.  0.1069  -0.150684  0.0900144  0.  0.  0.  0.  0.  0.  0.  0.341583  0.0744644  0.397553  0.0000677062  -0.0886312  0.  0.00009273  0.  0.  0.  0.  0.0630817  0.736948  -0.82073  -1.3931  0.0739959  -0.0630817  2.54556  -0.0630817  -0.00000000000000377476  -0.546211  0.00153666  0.364138  -0.147568;
-0.264172  0.  -0.0142305  -0.0281176  0.0136133  0.  0.  0.  0.  0.  0.  0.  0.429862  0.  0.0180164  0.120136  -0.124937  0.  0.  0.  0.  0.  0.  0.  0.00326808  0.  -0.0931677  -0.06289  -0.0511603  0.  0.  0.  0.  0.  0.  0.  -0.530657  -0.219733  0.0344385  0.240695  -0.241231  0.  -0.000646028  0.  0.  0.  0.  -0.439475  0.141415  0.105813  -0.206128  -0.274872  0.439475  0.488472  0.439475  -0.0000000000000586198  -0.104814  0.000294874  0.0698752  0.422092;
0.0570245  0.  -0.0279439  0.0111464  -0.0467962  0.  0.  0.  0.  0.  0.  0.  0.037279  0.  -0.0490003  0.00681408  0.0997783  0.  0.  0.  0.  0.  0.  0.  -0.241121  0.  0.0639716  -0.0779221  0.0126659  0.  0.  0.  0.  0.  0.  0.  -0.610873  0.481671  0.00815942  0.098117  0.207004  0.  -0.00114112  0.  0.  0.  0.  0.140158  -0.000000000000185074  -0.54194  0.0333889  -0.0523045  -0.27341  -0.00000000000000177636  0.776273  0.000000000000185019  0.0000000000000000277556  0.000000000000000166533  0.0000000000000000277556  -0.139136;
-0.0446255  0.  0.0872105  -0.0208645  0.1198  0.  0.  0.  0.  0.  0.  0.  -0.23506  0.  0.127279  -0.0605084  -0.240235  0.  0.  0.  0.  0.  0.  0.  0.636984  0.  -0.171034  0.238991  -0.0431004  0.  0.  0.  0.  0.  0.  0.  -0.224732  0.623252  -0.107629  -0.28619  -0.473214  0.  0.000349464  0.  0.  0.  0.  -0.0905662  -0.000000000000245581  -0.701236  0.0593956  0.159336  0.643899  0.00000000000000310862  -0.23773  0.000000000000245498  -0.0000000000000000277556  0.0000000000000001249  -0.0000000000000000693889  0.0880941;
-0.472443  0.  -0.141047  -0.0311881  -0.137995  0.  0.  0.  0.  0.  0.  0.  1.24527  0.  -0.135171  0.335223  0.0489882  0.  0.  0.  0.  0.  0.  0.  -0.883137  0.  0.000313141  -0.451698  -0.081838  0.  0.  0.  0.  0.  0.  0.  0.494699  0.0654831  0.128  0.976843  0.144181  0.  0.000172319  0.  0.  0.  0.  0.0545049  0.000000000000000999201  -0.0736767  -0.0586851  -0.893499  0.11399  0.00000000000000799361  -0.117224  -0.00000000000000122125  -0.0000000000000000832667  -0.0000000000000000555112  0.  -0.0536351;
0.0942838  0.  -0.0443322  0.0185761  -0.071841  0.  0.  0.  0.  0.  0.  0.  0.0324539  0.  -0.0763846  0.00496566  0.163326  0.  0.  0.  0.  0.  0.  0.  -0.365942  0.  0.112073  -0.118699  0.0301679  0.  0.  0.  0.  0.  0.  0.  0.470204  0.22726  0.0339707  0.11974  0.328162  0.  0.000291723  0.  0.  0.  0.  -0.825483  -0.0000000000000868194  -0.255696  0.0144344  -0.0431704  -0.458135  -0.00000000000000710543  -0.198451  0.0000000000000868194  0.000000000000000222045  0.000000000000000111022  0.  0.827137;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.;
0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]::Array{Float64,2}

condn=0.0000000001::Float64

iqNewMatlab=7

nnumericMatlab=7

(hNewJulia,qNewJulia,iqNew,nnumeric)=numericShift!(hhIn,qq,0,qRows,qCols,neq,condn)
isapprox(hNewJulia,hNewMatlab,rtol=0.1e-16::Float64,atol=0.0::Float64)&&
sameSpan(qNewJulia,qNewMatlab)&&
iqNew==iqNewMatlab&&
nnumeric==nnumericNewMatlab
end;

end
